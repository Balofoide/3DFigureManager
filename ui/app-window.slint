import { Theme } from "styling.slint";
import { Container, SideButton, InputField, OverviewCard } from "components.slint";
import {Button, ComboBox, LineEdit,VerticalBox, HorizontalBox, GridBox, ListView} from "std-widgets.slint";
import { dashboard_screen } from "screens/dashboard.slint";
import { calculator_screen } from "screens/product_calculator.slint";
import { estoque_screen} from "screens/estoque.slint";
import { Database, Impressoras, Estoque-Database } from "shared.slint";
import { printer-screen } from "screens/printer.slint";

export component AppWindow inherits Window {
    function activate(i: int) {
        Calculator_Screen.visible = (i == 1);
        Estoque_Screen.visible = (i == 2);
        Printer_Screen.visible = (i == 3);
 
        Dashboard_Screen.visible = (i == 5);
    }

    in-out property <string> filamento;
    in-out property <string> material;
    in-out property <string> tempo;
    in-out property <string> energia;
    in-out property <string> lucro;
    in-out property <float> total;
    in-out property <string> nome_cliente;
    in-out property <string> endereco;
    in-out property <string> entrega;
    in-out property <string> input_modelo;
    in-out property <string> input_watts;
    in-out property <[Impressoras]> impressoras;
    in-out property <[string]> impressoras_string;
    in-out property <[Database]> clients_database;
    in-out property <[Estoque-Database]> estoque_database;
    in-out property <string> estoque_material;
    in-out property <string> estoque_quantidade;
    in-out property <string> estoque_quantidade_total;
    in-out property <string> estoque_medida;
    in-out property <float> vendas_total;
    in-out property <string> combobox_selected;

    callback calcular_preco();
    callback registrar_cliente();
    callback registrar_impressora();
    callback registrar_estoque();

    width: 1280px;
    height: 820px;

    HorizontalBox {
        spacing: Theme.spacing;
        padding: Theme.spacing;
        width: parent.width;
        height: parent.height;

        /* --- SIDEBAR --- */
        VerticalBox {
            width: 15%;
            spacing: Theme.spacing;
            padding: Theme.spacing;

            SideButton { texto: "Tela 1"; clicked => { activate(1) } }
            SideButton { texto: "Tela 2"; clicked => { activate(2) } }
            SideButton { texto: "Tela 3"; clicked => { activate(3) } }
            SideButton { texto: "Tela 4"; clicked => { activate(4) } }
            SideButton { texto: "Tela 5"; clicked => { activate(5) } }
        }

        /* --- CONTEÃšDO PRINCIPAL --- */
        Rectangle {
            background: Theme.background;
            padding: Theme.spacing;
            clip: true;
            visible: true;

            Calculator_Screen := calculator-screen {
                width: parent.width;
                height: parent.height;
                visible: true;
                filamento <=> filamento;
                material <=> material;
                tempo <=> tempo;
                energia <=> energia;
                lucro <=> lucro;
                total <=> total;
                nome_cliente <=> nome_cliente;
                endereco <=> endereco;
                entrega <=> entrega;
                impressoras_string <=> impressoras_string;
                combobox_selected <=> combobox_selected;

                registrar_cliente => { root.registrar_cliente(); activate(5);}
                calcular_preco => { root.calcular_preco(); }
                resetar_inputs => {
                    nome_cliente = "";
                    tempo = "";
                    energia = "";
                    lucro = "";
                    total = 0;
                    endereco = "";
                    entrega = "";
                    combobox_selected = "";
                    filamento = 0;
                    material = 0;
                }
            }

            Estoque_Screen := estoque-screen{
                visible: false;
                estoque_database <=> estoque_database;
                estoque_material <=> estoque_material;
                estoque_quantidade <=> estoque_quantidade;
                estoque_quantidade_total <=> estoque_quantidade_total;
                estoque_medida <=> estoque_medida;
            }

            Printer_Screen := printer-screen {
                visible: false;
                input_modelo <=> input_modelo;
                input_watts <=> input_watts;

                registrar_impressora => {
                    root.registrar_impressora();
                }
            }
 
            Dashboard_Screen := dashboard-screen {
                visible: false;
                width: parent.width;
                height: parent.height;
                clients_database <=> clients_database;
                vendas_total <=> vendas_total;
            }
        }
    }
}
